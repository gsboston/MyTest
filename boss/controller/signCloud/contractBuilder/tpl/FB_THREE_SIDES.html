<style>
    #fb_two.root-content {
        background-color: #f6f6f6;
    }

    #fb_two.root-content > div {
        position: relative;
        width: 920px;
        margin: 0 auto;
        background-color: white;
    }

    #fb_two > .fb_two-content {
        padding: 20px 65px 40px 15px;
    }

    #fb_two .part-title {
        font-size: 18px;
        padding-left: 40px;
        padding-bottom: 20px;
        color: #59b399;
    }

    #fb_two .fb_two-content .ivu-form-item-error-tip {
        padding-top: 3px;
        font-size: 12px !important;
    }

    #fb_twoPlan .ivu-form-item-error-tip {
        padding-top: 3px;
        font-size: 12px !important;
        /*margin-top: -10px;*/
    }

    #fb_two .part-content {
        padding-left: 40px;
        padding-right: 20px;
    }

    #fb_two .part-content * {
        font-size: 14px !important;
    }

    #fb_two .text-row {
        display: inline-flex;
        align-items: center;
    }

    #fb_two .text-item {
        padding: 0 0 15px;
        white-space: nowrap;
    }

    #fb_two .discount {
        font-size: 12px !important;
        color: #dddee1;
    }

    #fb_two .text-input {
        width: 100px;
    }

    #fb_two .began-date .ivu-form-item-error-tip {
        font-size: 12px !important;
        position: absolute;
    }

    #fb_two .text-input input {
        border-top: none;
        border-left: none;
        border-right: none;
        text-align: center;
        height: 30px;
        font-size: 14px;
    }

    #fb_two .ivu-input, .ivu-select-selection {
        border-radius: 0;
    }

    #fb_two .last-row {
        margin-left: 40px;
        padding-top: 28px;
    }

    #fb_two .last-row .text-item {
        font-size: 14px;
        font-weight: bold;
    }

    #fb_two .last-row .text-item-total-price {
        font-size: 18px;
        font-weight: bold;
        height: 45px;
        line-height: 45px;
        margin-bottom: 15px;
    }

    #fb_two .last-row .text-item-symbol {
        font-size: 14px;
        position: relative;
        top: 1px;
    }

    #fb_two .last-row .text-item-symbol-total-price {
        font-size: 14px;
        height: 45px;
        line-height: 50px;
        margin-bottom: 15px;
    }

    #fb_two .other-item-content input {
        height: 39px;
        line-height: 39px;
        border-top: none;
        border-left: none;
        border-right: none;
    }

    #fb_two .last-total {
        float: right;
    }

    .fb_two-content .ivu-form .ivu-form-item-label {
        text-align: justify;
        text-align-last: justify;
        vertical-align: middle;
        float: left;
        color: rgb(51, 51, 51);
        line-height: 1;
        padding: 10px 20px 10px 0;
        box-sizing: border-box;
    }

    .fb_two-content .ivu-form-item {
        margin-bottom: 15px;
        vertical-align: top;
        zoom: 1;
    }

    .fb_two-content .ivu-select-arrow {
        position: absolute;
        top: 50%;
        right: 15px;
        line-height: 1;
        margin-top: -7px;
        font-size: 14px;
        color: #80848f;
        transition: all .2s ease-in-out;
    }

    #fb_two .fb_two-content .ivu-checkbox {
        display: inline-block;
        vertical-align: middle;
        white-space: nowrap;
        cursor: pointer;
        outline: 0;
        line-height: 1;
        position: relative;
        padding-right: 10px;
    }

    #fb_two .fb_two-content .ivu-radio {
        display: inline-block;
        margin-right: 12px;
        white-space: nowrap;
        outline: 0;
        position: relative;
        line-height: 1;
        vertical-align: middle;
        cursor: pointer;
    }

    #fb_two hr {
        margin-top: 20px;
        background-color: #e5e5e5;
        height: 1px;
        border: none;
    }

    #fb_two .form-input {
        width: 260px;
    }

    #fb_two .form-input-name {
        width: 110px;
    }

    #fb_two .form-input-tel {
        width: 140px;
    }

    #fb_two .form-input-price > input {
        position: relative;
        top: -5px;
        font-size: 20px;
    }

    #fb_two .form-input-price-total-price > input {
        position: relative;
        top: -5px;
        font-size: 30px;
        color: #ff5a5a;
    }

    #fb_two .extra > div {
        font-size: 14px !important;
    }

    #fb_two .extra .ivu-input {
        height: 20px;
    }

    #fb_two .extra .text-input {
        top: 0;
    }

    #fb_two .extra .ivu-form-item-content {
        line-height: 20px;
    }

    #fb_two .extra .ivu-row {
    }

    #fb_two .ivu-input[disabled], fieldset[disabled] .ivu-input {
        background-color: #f3f3f3;
        opacity: 1;
        cursor: not-allowed;
        color: #333;
    }

    #fb_two .ivu-select-disabled .ivu-select-selection {
        background-color: #f3f3f3;
        opacity: 1;
        cursor: not-allowed;
        color: #333;
    }

    #fb_two .autoInput .ivu-auto-complete .ivu-select-dropdown {
        max-height: 200px !important;
    }

    #fb_two .tips .ivu-tooltip-inner {
        white-space: inherit;
    }

    #fb_two .other-content {
        display: flex;
        display: -ms-flex;
    }

    #fb_two .operate-btn {
        padding: 8px 12.5px;
    }

    #fb_two .operate-btn.active {
        background: #59b399;
        color: #FFF;
    }

    #fb_two .operate-btn >>> .ivu-icon::before {
        font-weight: bolder;
    }

    #fb_two .contract {
        width: 100px;
        height: 135px;
        margin: auto;
        margin-bottom: 10px;
        background-image: url("/static/contract/contract-bg.png");
        background-repeat: no-repeat;
        background-size: 100% 100%;
        border: 1px dotted #a1a1a1;
        border-radius: 5px;
    }

    #fb_two .upload-css {
        margin: auto;
        display: inherit;
    }
</style>
<div id="fb_two" class="root-content">

    <div class="fb_two-content" style="position: relative;">
        <i-form :model="mainInfo" :label-width="90" :rules="ruleForm" ref="mainInfo">
            <Row>
                <!-- 甲方基本信息 -->
                <i-col span="12" :style="{'background':1== selectedArea ?'#f6faf9' :''}">
                    <div class="part-title">甲方基本信息</div>
                    <div class="part-content" @mousedown="selectArea(1)">
                        <Form-item label="类型" prop="type">
                            <radio-group v-model="mainInfo.cSList[0].type" @on-change="changeCsType">
                                <Radio label="COMPANY" :disabled="!isEditable">企业</Radio>
                                <Radio label="PERSON" :disabled="!isEditable">自然人</Radio>
                            </radio-group>
                        </Form-item>
                        <Form-item :label="mainInfo.cSList[0].type=='COMPANY'?'公司名称':'姓名'" prop="cSList[0].name"
                                   class="autoInput">
                            <Tooltip class="tips" :disabled="!mainInfo.cSList[0].name"
                                     :content="mainInfo.cSList[0].name" class="tips" placement="bottom">
                                <auto-comp ref="autoName" :disabled="!isEditable" class="form-input"
                                           v-model="mainInfo.cSList[0].name" @on-search="searchCustomerByName"
                                           @on-select="selectCustomer">
                                    <i-option v-for="item in customerList" :value="item.name" :key="item.id">
                                        {{item.name}}
                                    </i-option>
                                </auto-comp>
                            </Tooltip>
                        </Form-item>
                        <Form-item label="证件号码" prop="cSList[0].idno" class="autoInput">
                            <Tooltip :disabled="!mainInfo.cSList[0].idno" :content="mainInfo.cSList[0].idno"
                                     class="tips" placement="bottom">
                                <auto-comp :maxlength="25" ref="autoNO" :disabled="!isEditable" class="form-input"
                                           :placeholder="mainInfo.cSList[0].type=='COMPANY'?'税务登记证号/统一信用代码':'身份证号'"
                                           class="form-input" v-model="mainInfo.cSList[0].idno"
                                           @on-search="searchCustomerByNo" @on-select="selectCustomerNo">
                                    <i-option v-for="item in customerListNo" :value="item.IDNumber" :key="item.id">
                                        {{item.IDNumber}}
                                    </i-option>
                                </auto-comp>
                            </Tooltip>
                        </Form-item>
                        <Row>
                            <i-col span="13">
                                <Form-item label="联系人" prop="cSList[0].contactName">
                                    <Tooltip :disabled="!mainInfo.cSList[0].contactName"
                                             :content="mainInfo.cSList[0].contactName" class="tips" placement="bottom">
                                        <i-input :disabled="!isEditable" class="form-input-name" :maxlength="20"
                                                 v-model="mainInfo.cSList[0].contactName" placeholder="联系人姓名"></i-input>
                                    </Tooltip>
                                </Form-item>
                            </i-col>
                            <i-col span="10" offset="1">
                                <Form-item :label-width='1' prop="cSList[0].contactPhone">
                                    <Tooltip :disabled="!mainInfo.cSList[0].contactPhone"
                                             :content="mainInfo.cSList[0].contactPhone" class="tips" placement="bottom">
                                        <i-input :disabled="!isEditable" class="form-input-tel" :maxlength="17"
                                                 v-model="mainInfo.cSList[0].contactPhone" placeholder="联系电话"
                                                 style="width: 140px"></i-input>
                                    </Tooltip>
                                </Form-item>
                            </i-col>
                        </Row>
                        <!--<Form-item label="电子邮箱" prop="cSList[0].email">-->
                        <Form-item label="电子邮箱">
                            <Tooltip :disabled="!mainInfo.cSList[0].email" :content="mainInfo.cSList[0].email"
                                     class="tips" placement="bottom">
                                <i-input :disabled="!isEditable" class="form-input" :maxlength="50"
                                         v-model="mainInfo.cSList[0].email" placeholder="电子邮箱"></i-input>
                            </Tooltip>

                        </Form-item>
                        <Form-item label="联系地址" prop="cSList[0].address">
                            <Tooltip class="tips" :disabled="!mainInfo.cSList[0].address"
                                     :content="mainInfo.cSList[0].address" class="tips" placement="bottom">
                                <i-input :disabled="!isEditable" class="form-input" :maxlength="100"
                                         v-model="mainInfo.cSList[0].address" placeholder="实际通讯地址而非企业的工商注册地址"></i-input>
                            </Tooltip>
                        </Form-item>
                    </div>
                </i-col>
                <!-- 乙方基本信息 -->
                <i-col span="12" :style="{'background':2== selectedArea ?'#f6faf9' :''}">
                    <div class="part-title">乙方基本信息</div>
                    <div class="part-content" @mousedown="selectArea(2)">
                        <Form-item label="企业名称" prop="cSList[1].name">
                            <Tooltip class="tips" :disabled="!mainInfo.cSList[1].name"
                                     :content="mainInfo.cSList[1].name" class="tips" placement="bottom">
                                <i-input v-if="!isEditable" disabled class="form-input"
                                         v-model="mainInfo.cSList[1].name"></i-input>
                                <i-select v-if="isEditable" class="form-input" @on-change="selectInfo"
                                          v-model="mainInfo.cSList[1].name">
                                    <i-option v-for="item in companyList" :value="item.name" :key="item.name">
                                        {{ item.name }}
                                    </i-option>
                                </i-select>
                            </Tooltip>
                        </Form-item>
                        <Form-item label="开户银行">
                            <Tooltip class="tips" :disabled="!mainInfo.cSList[1].bankName"
                                     :content="mainInfo.cSList[1].bankName" class="tips" placement="bottom">
                                <i-input class="form-input" v-model="mainInfo.cSList[1].bankName" placeholder="开户银行"
                                         disabled></i-input>
                            </Tooltip>
                        </Form-item>
                        <Form-item label="银行账号">
                            <Tooltip :disabled="!mainInfo.cSList[1].bankAccount"
                                     :content="mainInfo.cSList[1].bankAccount" class="tips" placement="bottom">
                                <i-input class="form-input" v-model="mainInfo.cSList[1].bankAccount" placeholder="银行账号"
                                         disabled></i-input>
                            </Tooltip>
                        </Form-item>
                        <Row>
                            <i-col span="13">
                                <Form-item label="联系人" prop="cSList[1].contactName">
                                    <Tooltip :disabled="!mainInfo.cSList[1].contactName"
                                             :content="mainInfo.cSList[1].contactName" class="tips" placement="bottom">
                                        <i-input :disabled="!isEditable" class="form-input-name" :maxlength="20"
                                                 v-model="mainInfo.cSList[1].contactName" placeholder="联系人姓名"></i-input>
                                    </Tooltip>
                                </Form-item>
                            </i-col>
                            <i-col span="10" offset="1">
                                <Form-item :label-width="1" prop="cSList[1].contactPhone">
                                    <Tooltip :disabled="!mainInfo.cSList[1].contactPhone"
                                             :content="mainInfo.cSList[1].contactPhone" class="tips" placement="bottom">
                                        <i-input :disabled="!isEditable" class="form-input-tel" :maxlength="11"
                                                 v-model="mainInfo.cSList[1].contactPhone" placeholder="联系电话"></i-input>
                                    </Tooltip>
                                </Form-item>
                            </i-col>
                        </Row>
                        </Form-item>
                        <Form-item label="电子邮箱">
                            <Tooltip :disabled="!mainInfo.cSList[1].email" :content="mainInfo.cSList[1].email"
                                     class="tips" placement="bottom">
                                <i-input class="form-input" v-model="mainInfo.cSList[1].email" placeholder="电子邮箱"
                                         :disabled="!isEditable"></i-input>
                            </Tooltip>
                        </Form-item>
                        <Form-item label="联系地址">
                            <Tooltip class="tips" :disabled="!mainInfo.cSList[1].address"
                                     :content="mainInfo.cSList[1].address" class="tips" placement="bottom">
                                <i-input class="form-input" v-model="mainInfo.cSList[1].address"
                                         placeholder="实际通讯地址而非企业的工商注册地址" disabled></i-input>
                            </Tooltip>
                        </Form-item>
                    </div>
                </i-col>
            </Row>
            <hr/>
            <Row class="aaa">
                <i-col span="12" :style="{'background':6== selectedArea ?'#f6faf9' :''}" style="margin-top: 20px">
                    <div class="part-title">丙方基本信息</div>
                    <div class="part-content" @mousedown ="selectArea(6)">
                        <Form-item label="公司名称" prop="cSList[2].name">
                            <Tooltip :disabled="!mainInfo.cSList[2].name" :content="mainInfo.cSList[2].name" class="tips" placement="bottom">
                                <i-input class="form-input" v-model="mainInfo.cSList[2].name" placeholder="新设公司暂定名称" :maxlength="50" :disabled="!isEditable"></i-input>
                            </Tooltip>
                        </Form-item>
                        <!--<Form-item label="证件号码" prop="cSList[2].idno">-->
                        <Form-item label="证件号码">
                            <Tooltip :disabled="!mainInfo.cSList[2].idno" :content="mainInfo.cSList[2].idno" class="tips" placement="bottom">
                                <i-input class="form-input" v-model="mainInfo.cSList[2].idno" placeholder="法人身份证号" :maxlength="50" :disabled="!isEditable"></i-input>
                            </Tooltip>
                        </Form-item>
                        <Row>
                            <i-col span="13">
                                <Form-item label="联系人" prop="cSList[2].contactName">
                                    <Tooltip :disabled="!mainInfo.cSList[2].contactName" :content="mainInfo.cSList[2].contactName" class="tips" placement="bottom">
                                        <i-input class="form-input-name" v-model="mainInfo.cSList[2].contactName" :maxlength="20" placeholder="联系人姓名" :disabled="!isEditable"></i-input>
                                    </Tooltip>
                                </Form-item>
                            </i-col>
                            <i-col span="10" offset="1">
                                <Form-item :label-width='1' prop="cSList[2].contactPhone">
                                    <Tooltip :disabled="!mainInfo.cSList[2].contactPhone" :content="mainInfo.cSList[2].contactPhone" class="tips" placement="bottom">
                                        <i-input class="form-input-tel" v-model="mainInfo.cSList[2].contactPhone" :maxlength="17" placeholder="联系电话" style="width: 140px" :disabled="!isEditable"></i-input>
                                    </Tooltip>
                                </Form-item>
                            </i-col>
                        </Row>
                        <!--<Form-item label="电子邮箱" prop="cSList[2].email">-->
                        <Form-item label="电子邮箱">
                            <Tooltip :disabled="!mainInfo.cSList[2].email" :content="mainInfo.cSList[2].email" class="tips" placement="bottom">
                                <i-input class="form-input" v-model="mainInfo.cSList[2].email" placeholder="电子邮箱" :maxlength="50" :disabled="!isEditable"></i-input>
                            </Tooltip>
                        </Form-item>
                        <Form-item label="联系地址" prop="cSList[2].address">
                            <Tooltip :disabled="!mainInfo.cSList[2].address" :content="mainInfo.cSList[2].address" class="tips" placement="bottom">
                                <i-input class="form-input" v-model="mainInfo.cSList[2].address" placeholder="实际通讯地址而非企业的工商注册地址" :maxlength="100" :disabled="!isEditable"></i-input>
                            </Tooltip>
                        </Form-item>
                    </div>
                </i-col>
            </Row>
            <hr/>
            <!-- 甲方办理业务内容 -->
            <Row style="margin-top: 40px">
                <i-col span="24" :style="{'background':3== selectedArea ?'#f6faf9' :''}">
                    <div class="part-title">甲方所办理的业务内容</div>
                    <div class="part-content" @mousedown="selectArea(3)">
                        <Form-item label="委托事项">
                            <Row v-for="(item, index) in mainInfo.content.otherItem" :key="index" style="margin-bottom: 10px;">
                                <i-col span="19">
                                    <i-input :readonly="!isEditable" class="other-item-content"
                                             v-model="item.content"></i-input>
                                </i-col>
                                <i-col v-if="isEditable" span="2" offset="1">
                                    <i-button icon="plus-round" type="ghost" class="operate-btn"
                                              @click="addFileRow"></i-button>
                                </i-col>
                                <i-col span="2" v-if="isEditable && mainInfo.content.otherItem.length > 1 && index != 0">
                                    <i-button icon="close-round" type="ghost" class="operate-btn"
                                              @click="removeFileRow(index)"></i-button>
                                </i-col>
                            </Row>
                        </Form-item>
                    </div>
                </i-col>
            </Row>
            <hr/>
            <Row style="margin-top: 40px">
                <i-col span="24" :style="{'background':4== selectedArea ?'#f6faf9' :''}">
                    <div class="part-title">服务期限约定</div>
                    <div class="part-content" @mousedown="selectArea(4)">
                        <Form-item label="服务频率">
                            <Radio-Group :disabled="!isEditable" v-model="mainInfo.content.serviceFrequency">
                                <Radio label="DISPOSABLE" :disabled="!isEditable">一次性</Radio>
                                <Radio style="margin-left: 42px" label="PERIODIC" :disabled="!isEditable">周期性</Radio>
                            </Radio-Group>
                        </Form-item>
                        <Radio-Group :disabled="!isEditable" v-model="mainInfo.periodType">
                            <Row>
                                <Radio label="START_END" :disabled="!isEditable">明确的服务起始周期</Radio>
                                <Radio style="margin-left: 42px" label="NONE" :disabled="!isEditable">无明确服务起始周期</Radio>
                                <Radio v-if="mainInfo.content.serviceFrequency == 'DISPOSABLE'" style="margin-left: 42px" label="DATE" :disabled="!isEditable">按日期计算</Radio>
                            </Row>
                            <br>
                            <div v-if="mainInfo.content.serviceFrequency == 'DISPOSABLE'">
                                <div style="display: inline-block;width: 600px" v-if="mainInfo.periodType=='START_END'">
                                    <Row>
                                        <i-col span="8" style="width: 285px">
                                            <Form-item label="起始日期" prop="periodStart">
                                                <date-picker :disabled="!isEditable" type="date" placeholder="选择日期"
                                                             v-model="mainInfo.periodStart"
                                                             @on-change="changeStartDate"></date-picker>
                                            </Form-item>
                                        </i-col>
                                        <i-col span="8" style="width: 285px;margin-left: 30px">
                                            <Form-item label="结束日期" prop="periodEnd">
                                                <date-picker :disabled="!isEditable" type="date" placeholder="选择日期"
                                                             v-model="mainInfo.periodEnd"
                                                             @on-change="changeEndDate"></date-picker>
                                            </Form-item>
                                        </i-col>
                                    </Row>
                                </div>
                                <div class="began-date" v-if="mainInfo.periodType=='NONE'">
                                    <Row>
                                        <div class="text-row">
                                            <div class="text-item">本合同委托期限自</div>
                                            <Form-item :label-width="1" prop="content.noneTypeStart">
                                                <i-input :readonly="!isEditable" class="text-input" style="width:200px"
                                                         type="text" v-model="mainInfo.content.noneTypeStart"></i-input>
                                            </Form-item>
                                            <div class="text-item">之日起至委托事项完成，以</div>
                                            <Form-item :label-width="1" prop="content.noneTypeEnd">
                                                <!--<i-input :readonly="!isEditable" :maxlength="3" class="text-input"-->
                                                <!--type="text" v-model="mainInfo.content.noneTypeMonth"></i-input>-->
                                                <i-input :readonly="!isEditable" class="text-input" style="width:200px"
                                                         type="text" v-model="mainInfo.content.noneTypeEnd"></i-input>
                                            </Form-item>
                                            <div class="text-item">视为委托事项完成</div>
                                        </div>
                                    </Row>
                                </div>
                                <div class="began-date" v-if="mainInfo.periodType=='DATE'">
                                    <Row>
                                        <div class="text-row">
                                            <div class="text-item">本合同委托期限自本合同签字或盖章之日起共</div>
                                            <Form-item :label-width="1" prop="content.dateTypeDays">
                                                <i-input :readonly="!isEditable" class="text-input" style="top: 0"
                                                         :maxlength="6" type="text"
                                                         v-model="mainInfo.content.dateTypeDays"></i-input>
                                            </Form-item>
                                            <Form-item :label-width="1">
                                                <Radio-Group :disabled="!isEditable"
                                                             v-model="mainInfo.content.dateTypeDaysType">
                                                    <Radio label="DAY" :disabled="!isEditable">天</Radio>
                                                    <Radio label="MONTH" :disabled="!isEditable">月</Radio>
                                                </Radio-Group>
                                            </Form-item>
                                        </div>
                                    </Row>
                                </div>
                            </div>
                            <div v-else>
                                <div style="display: inline-block;width: 600px" v-if="mainInfo.periodType=='START_END'">
                                    <Row>
                                        <i-col span="8" style="width: 285px">
                                            <Form-item label="起始日期" prop="periodStart">
                                                <date-picker :disabled="!isEditable" type="month" placeholder="选择日期"
                                                             v-model="mainInfo.periodStart"
                                                             @on-change="changeStartDate"></date-picker>
                                            </Form-item>
                                        </i-col>
                                        <i-col span="8" style="width: 285px;margin-left: 30px">
                                            <Form-item label="结束日期" prop="periodEnd">
                                                <date-picker :disabled="!isEditable" type="month" placeholder="选择日期"
                                                             v-model="mainInfo.periodEnd"
                                                             @on-change="changeEndDate"></date-picker>
                                            </Form-item>
                                        </i-col>
                                    </Row>
                                    <Row>
                                        <div class="text-row">
                                            <div class="text-item">共计</div>
                                            <Form-item :label-width="1" prop="content.totalMonth">
                                                <i-input :readonly="!isEditable" class="text-input" readOnly type="text"
                                                         v-model="mainInfo.content.totalMonth"></i-input>
                                            </Form-item>
                                            <div class="text-item">个月，含赠送</div>
                                            <Form-item :label-width="1" prop="content.freeMonth">
                                                <i-input :readonly="!isEditable" :maxlength="2" class="text-input"
                                                         type="text" v-model="mainInfo.content.freeMonth"></i-input>
                                            </Form-item>
                                            <div class="text-item">个月</div>
                                        </div>
                                    </Row>
                                </div>
                                <div class="began-date" v-if="mainInfo.periodType=='NONE'">
                                    <Row>
                                        <div class="text-row">
                                            <div class="text-item">双方同意服务期限以</div>
                                            <Form-item :label-width="1" prop="content.noneTypeStart">
                                                <i-input :readonly="!isEditable" class="text-input" style="width:200px"
                                                         type="text" v-model="mainInfo.content.noneTypeStart"></i-input>
                                            </Form-item>
                                            <div class="text-item">开始计算，委托期限自即日起开始共计</div>
                                            <Form-item :label-width="1" prop="content.noneTypeMonth">
                                                <i-input :readonly="!isEditable" :maxlength="3" class="text-input"
                                                         type="text" v-model="mainInfo.content.noneTypeMonth"></i-input>
                                            </Form-item>
                                            <div class="text-item">个月</div>
                                        </div>
                                    </Row>
                                    <Row>
                                        <div class="text-row">
                                            <div class="text-item">含赠送</div>
                                            <Form-item :label-width="1" prop="content.noneTypeFreeMonth">
                                                <i-input :readonly="!isEditable" :maxlength="3" class="text-input"
                                                         type="text" v-model="mainInfo.content.noneTypeFreeMonth"></i-input>
                                            </Form-item>
                                            <div class="text-item">个月</div>
                                        </div>
                                    </Row>
                                </div>
                            </div>
                        </Radio-Group>
                    </div>
                </i-col>
            </Row>
            <hr/>
            <Row id="fb_twoPlan" style="margin-top: 40px">
                <i-col span="24" :style="{'background':5== selectedArea ?'#f6faf9' :''}">
                    <div class="part-title">甲方支付方案</div>
                    <div class="part-content" @mousedown="selectArea(5)">
                        <Radio-Group :disabled="!isEditable" v-model="mainInfo.paymentType">
                            <Row>
                                <Radio label="ONCE" :disabled="!isEditable">一次性支付</Radio>
                                <Radio style="margin-left: 42px" label="BATCH" :disabled="!isEditable">分笔支付</Radio>
                                <Radio v-if="mainInfo.content.serviceFrequency == 'PERIODIC'" style="margin-left: 42px" label="QUARTERLY" :disabled="!isEditable">周期支付</Radio>
                            </Row>
                            <br>
                            <Row v-if="mainInfo.paymentType=='ONCE'">
                                <div class="text-row">
                                    <div class="text-item">甲方于本合同生效后</div>
                                    <Form-item :label-width="1" prop="content.payWayOnceDaysItem">
                                        <i-input :readonly="!isEditable" class="text-input" type="text"
                                                 v-model="mainInfo.content.payWayOnceDaysItem" :maxlength="2"></i-input>
                                    </Form-item>
                                    <div class="text-item">日内将上述服务费用一次性支付给乙方，乙方在收到全部服务费用后开展委托事项工作。</div>
                                </div>
                            </Row>
                            <Row v-if="mainInfo.paymentType=='BATCH'">
                                <div class="text-row">
                                    <div class="text-item">甲方于本合同生效后</div>
                                    <Form-item :label-width="1" prop="content.payWayMonthlyFirstPayDay">
                                        <i-input :readonly="!isEditable" class="text-input" type="text"
                                                 v-model="mainInfo.content.payWayMonthlyFirstPayDay"
                                                 :maxlength="2"></i-input>
                                    </Form-item>
                                    <div class="text-item">日内支付首期服务费&nbsp￥</div>
                                    <Form-item :label-width="1" prop="content.payWayMonthlyFirstPay">
                                        <i-input :maxlength="6" :readonly="!isEditable" class="text-input" type="text"
                                                 v-model="mainInfo.content.payWayMonthlyFirstPay"></i-input>
                                    </Form-item>
                                    <div class="text-item">元（大写：人民币</div>
                                    <Form-item :label-width="1">
                                        <i-input class="text-input" type="text"
                                                 style="width: 150px" v-model="payWayMonthlyFirstPayD"
                                                 readonly></i-input>
                                    </Form-item>
                                    <div class="text-item">）</div>
                                </div>
                                <div class="text-row">
                                    <div class="text-item">余款服务费&nbsp￥</div>
                                    <Form-item :label-width="1" prop="content.payWayMonthlyOtherPay">
                                        <i-input :maxlength="6" :readonly="!isEditable" class="text-input" type="text"
                                                 v-model="mainInfo.content.payWayMonthlyOtherPay"></i-input>
                                    </Form-item>
                                    <div class="text-item">元（大写：人民币</div>
                                    <Form-item :label-width="1">
                                        <i-input class="text-input" type="text"
                                                 style="width: 150px" v-model="payWayMonthlyOtherPayD"
                                                 readonly></i-input>
                                    </Form-item>
                                    <div class="text-item">）于乙方完成委托事项后</div>
                                    <Form-item :label-width="1" prop="content.payWayMonthlyOtherPayDay">
                                        <i-input :maxlength="6" :readonly="!isEditable" class="text-input" type="text"
                                                 v-model="mainInfo.content.payWayMonthlyOtherPayDay"></i-input>
                                    </Form-item>
                                    <div class="text-item">日支付。</div>
                                </div>
                            </Row>
                            <Row v-if="mainInfo.paymentType=='QUARTERLY'">
                                <Radio-Group v-model="mainInfo.content.payType" @on-change="changePaymentType">
                                    <!--<Radio label="MONTHLY" :disabled="!isEditable">月</Radio>-->
                                    <Radio label="QUARTERLY" :disabled="!isEditable">季度</Radio>
                                    <Radio label="HALF_YEAR" :disabled="!isEditable">半年</Radio>
                                    <Radio label="PER_YEAR" :disabled="!isEditable">一年</Radio>
                                </Radio-Group>
                                <div class="text-row" style="margin-bottom: 10px;">
                                    <i-input :readonly="!isEditable" class="text-input" type="text"
                                             v-model="mainInfo.content.payWayRoundDaysItem" @on-change="changePayPrice"></i-input>
                                    <div class="text-item" style="padding: 0;">元/期</div>
                                </div>
                            </Row>
                        </Radio-Group>
                        <div>
                            <span style="display: inline-block;font-weight: bold">支付方式 :</span>
                            <Checkbox-Group style="display: inline-block;margin-left: 20px" v-model="tempPayment"
                                            @on-change="changePayment">
                                <Checkbox label="WECHAT" :disabled="!isEditable">对公转账</Checkbox>
                                <Checkbox label="CHECK" :disabled="!isEditable">现金（支付宝、微信支付）</Checkbox>
                                <Checkbox label="POS" :disabled="!isEditable">POS 机刷卡</Checkbox>
                                <Checkbox label="ONLINE" :disabled="!isEditable">线上支付</Checkbox>
                            </Checkbox-Group>
                        </div>
                    </div>
                </i-col>
            </Row>
            <Row class="last-row" :style="{'background':8== selectedArea ?'#f6faf9' :''}">
                <div class="text-row" @mousedown="selectArea(8)">
                    <div class="text-item-total-price">合约总额&nbsp</div>
                    <div class="text-item-symbol-total-price">￥</div>
                    <Form-item v-if="mainInfo.paymentType!='BATCH'" style="margin-left: 10px;margin-right: 10px" :label-width="1" prop="price">
                        <i-input :readonly="!isEditable" class="text-input form-input-price-total-price"
                                 style="top:0;width: 200px" type="text" v-model="mainInfo.price"></i-input>
                    </Form-item>
                    <div v-if="mainInfo.paymentType=='BATCH'" >
                        <i-input class="text-input form-input-price-total-price" style="width:200px;" type="text" v-model="otherPrice" readOnly></i-input>
                    </div>
                    <div class="text-item">元</div>
                </div>
            </Row>
            <div>
                <div class="hr-css"></div>
                <Row align="top" style="padding-left: 40px;padding-top: 40px">
                    <i-col span="3">
                        <span style="color: #59b399;font-size: 18px">合同正本</span>
                    </i-col>
                    <i-col span="18">
                        <i-col span="5" v-for="(fileItem,index) in mainInfo.contentAttList" :key="index" :value="fileItem.contentAttachmentId">
                            <div class="contract" @click="showFile(fileItem.contentAttachmentId)">
                                <div v-if="isEditable" style="position: relative;left: 82px;width: 18px;height: 18px;background: #a1a1a1;cursor: pointer" @click.stop="removeFile(index)">
                                    <Icon style="text-align: center;width: 100%;font-size: 18px;color: #e5e5e5;" type="close-round"></Icon>
                                </div>
                            </div>
                        </i-col>
                        <i-col span="5" v-if="isEditable">
                            <div class="upload-css">
                                <cupload style="position: absolute" :before-upload="beforeFileUpload" :on-success="onFileSuccess" :max-size="20480" :show-process="false" :type="['doc','docx','pdf','jpg','png','jpeg']">
                                    <Icon type="plus-round" style="font-size: 28px;color: #59b399;"></Icon>
                                    <div style="width: 90px;line-height: 15px;">
                                        <span style="font-size: 12px">*支持word、pdf、jpg、png、jpeg等文件，大小不超过20M</span>
                                    </div>
                                </cupload>
                            </div>
                        </i-col>
                    </i-col>
                </Row>
            </div>
        </i-form>
        <br>
    </div>
</div>
<script>
    var cupload = Vue.options.components.BSUpload;
    new Vue({
        el: "#fb_two",
        components: {
            cupload: cupload
        },
        computed: {
            payWayMonthlyFirstPayD: function () {
                var str = String.transformPay(this.mainInfo.content.payWayMonthlyFirstPay);
                this.mainInfo.content.payWayMonthlyFirstPayD = str;
                return str;
            },
            payWayMonthlyOtherPayD: function () {
                var str = String.transformPay(this.mainInfo.content.payWayMonthlyOtherPay);
                this.mainInfo.content.payWayMonthlyOtherPayD = str;
                return str;
            },
            otherPrice:function() {
                var first = isNaN(this.mainInfo.content.payWayMonthlyFirstPay)?0:this.mainInfo.content.payWayMonthlyFirstPay;
                var other = isNaN(this.mainInfo.content.payWayMonthlyOtherPay)?0:this.mainInfo.content.payWayMonthlyOtherPay;
                this.mainInfo.price = Math.format(Number(first)+Number(other),2);
                return Math.format(Number(first)+Number(other),2);
            }
        },
        watch: {
            'mainInfo.content.serviceFrequency': function(val) {
                this.mainInfo.content.serviceFrequency = val;
                if (val == 'DISPOSABLE') {
                    if (this.mainInfo.paymentType == 'QUARTERLY') {
                        this.mainInfo.paymentType = 'ONCE';
                    }
                }else {
                    if (this.mainInfo.periodType == 'DATE') {
                        this.mainInfo.periodType = 'START_END';
                    }
                }
            }
        },
        data: function () {
            var vm = this;
            var validateStart = function (rule, value, callback) {
                if (value === '') {
                    callback(new Error('请选择开始日期'));
                } else {
                    if (vm.mainInfo.periodEnd != '' && value > vm.mainInfo.periodEnd) {
                        // 对第二个密码框单独验证
                        callback(new Error('开始时间不能大于结束时间'));
                    } else {
                        if (vm.mainInfo.content.serviceFrequency == 'PERIODIC') {
                            vm.$refs['mainInfo'].validateField('content.freeMonth');
                        }
                        callback();
                    }
                }
            };
            var validateEnd = function (rule, value, callback) {
                if (value === '') {
                    callback(new Error('请选择结束日期'));
                } else {
                    if (vm.mainInfo.periodStart != '' && value < vm.mainInfo.periodStart) {
                        // 对第二个密码框单独验证
                        callback(new Error('结束时间不能小于开始时间'));
                    } else {
                        if (vm.mainInfo.content.serviceFrequency == 'PERIODIC') {
                            vm.$refs['mainInfo'].validateField('content.freeMonth');
                        }
                    }
                    callback();
                }
            };
            var validateFree = function (rule, value, callback) {
                if (value != '' && vm.getPayMonths() < 0) {
                    callback(new Error('赠送服务期数不能大于总服务期数'));
                } else {
                    callback();
                }
            };
            return {
                op: "",
                customerList: [],
                customerListNo: [],
                isEditable: true,
                selectedArea: 0,
                isContractPerfect: false,
                mainInfo: {
                    contractDefId: "910039970264145922",
                    cSList: [{
                        type: 'COMPANY',
                        subjectAlias: "A",
                        signedType: "SEAL"
                    }, {
                        type: '',
                        subjectAlias: "B",
                        signedType: "SEAL"
                    },{
                        type:'COMPANY',
                        subjectAlias :"C",
                        signedType :"SIGNATURE"
                    }],
                    cRList: [],
                    content: {
                        payWayMonthlyFirstPay: 0,
                        payWayMonthlyFirstPayDay: '',
                        payWayMonthlyOtherPay: 0,
                        payWayMonthlyOtherPayDay: '',
                        payType: "QUARTERLY",
                        dateTypeDays: '',
                        dateTypeDaysType: 'DAY',
                        payWayOnceDaysItem: '',
                        payWayOtherDaysItem: '',
                        serviceFrequency: 'DISPOSABLE',
                        payWayRoundDaysItem: '',
                        otherItem: [],
                        freeMonth: '',
                        noneTypeFreeMonth: '',
                    },
                    paymentType: 'ONCE',
                    periodType: 'START_END',
                    payment: "",
                    contentAttList: [],
                    isCriterion: 0
                },
                tempPayment: [],
                companyList: [],
                ruleForm: {
                    price: [
                        { required: true, message: "价格不能为空"},
                        { pattern:  /^-?\d+(\.\d+)?$/ ,message:"请输入正确的价格"},
                        { pattern:   /^[0-9]+([.]{1}[0-9]{1,2})?$/ ,message:"小数保留两位"}
                    ],
                    "cSList[0].name": [
                        {required: true, message: '名称不能为空'}
                    ],
                    "cSList[0].idno": [
                        {required: true, message: '该项不能为空'},
                        {pattern: /^[A-Za-z0-9]+$/, message: '只能是英文或者数字'}
                    ],
                    "cSList[0].contactName": [
                        {required: true, message: '联系人不能为空'}
                    ],
                    "cSList[0].contactPhone": [
                        {required: true, message: '联系电话不能为空'}
                    ],
                    "cSList[0].address": [
                        {required: true, message: '地址不能为空'}
                    ],
                    "cSList[1].name": [
                        {required: true, message: '企业名不能为空'}
                    ],
                    "cSList[1].contactName": [
                        {required: true, message: '联系人不能为空'}
                    ],
                    "cSList[1].contactPhone": [
                        {required: true, message: '联系电话不能为空'}
                    ],
                    "cSList[2].name": [
                        { required: true, message: '名称不能为空' }
                    ],
                    "cSList[2].contactName": [
                        { required: true, message: '联系人不能为空' }
                    ],
                    "cSList[2].contactPhone": [
                        { required: true, message: '联系电话不能为空' }
                    ],
                    "cSList[2].address": [
                        { required: true, message: '地址不能为空' }
                    ],
                    periodStart: [
                        {required: true, type: 'date', message: '请选择日期', trigger: 'change'},
                        {validator: validateStart, trigger: 'change'}
                    ],
                    periodEnd: [
                        {required: true, type: 'date', message: '请选择日期', trigger: 'change'},
                        {validator: validateEnd, trigger: 'change'}
                    ],
                    "content.totalMonth": [
                        {required: true, message: '必填项'},
                        {pattern: /^[1-9]\d*$/, message: '请输入正整数'}
                    ],
                    "content.freeMonth": [
                        {pattern: /^[0-9]\d*$/, message: '请输入正整数'},
                        {validator: validateFree, trigger: 'change'}
                    ],
                    "content.noneTypeFreeMonth": [
                        {pattern: /^[0-9]\d*$/, message: '请输入正整数'},
                        {validator: validateFree, trigger: 'change'}
                    ],
                    "content.noneTypeStart": [
                        {required: true, message: '必填项'}
                    ],
                    "content.noneTypeEnd": [
                        {required: true, message: '必填项'}
                    ],
                    "content.noneTypeMonth": [
                        {required: true, message: '必填项'},
                        {pattern: /^[1-9]\d*$/, message: '请输入正整数'}
                    ],
                    "content.dateTypeDays": [
                        {required: true, message: '必填项'},
                        {pattern: /^[1-9]\d*$/, message: '请输入正整数'}
                    ],
                    "content.payWayOnceDaysItem": [
                        {required: true, message: '必填项'},
                        {pattern: /^[1-9]\d*$/, message: '请输入正整数'}
                    ],
                    "content.payWayMonthlyFirstPayDay": [
                        {required: true, message: '必填项'},
                        {pattern: /^[1-9]\d*$/, message: '请输入正整数'}
                    ],
                    "content.payWayMonthlyFirstPay": [
                        {required: true, message: '必填项'},
                        {pattern: /^[0-9]\d*$/, message: '请输入正整数'}
                    ],
                    "content.payWayMonthlyOtherPay": [
                        {required: true, message: '必填项'},
                        {pattern: /^[0-9]\d*$/, message: '请输入正整数'}
                    ],
                    "content.payWayMonthlyOtherPayDay": [
                        {required: true, message: '必填项'},
                        {pattern: /^[1-9]\d*$/, message: '请输入正整数'}
                    ],
                },
                singlePrice: 0
            }
        },
        created: function () {
            this.$api.contractSaveApi = this.save;
        },
        methods: {
            init: function (param) {
                if (param.isEditable == false) {
                    this.isEditable = false;
                }
                if (param.defaultInfo) {
                    this.mainInfo.cSList[0].type = param.defaultInfo.type;
                    this.mainInfo.cSList[0].name = param.defaultInfo.name;
                    this.mainInfo.cSList[0].idno = param.defaultInfo.idno;
                    this.mainInfo.cSList[0].contactName = param.defaultInfo.contactName;
                    this.mainInfo.cSList[0].contactPhone = param.defaultInfo.contactPhone;
                    this.mainInfo.cSList[0].email = param.defaultInfo.email;
                    this.mainInfo.cSList[0].address = param.defaultInfo.address;
                }
                if (param.contractId && param.contractId > 10000) {
                    this.op = "edit";
                    this.loadData(param.contractId);
                } else {
                    this.addFileRow();
                }
                if (param.defId) {
                    this.mainInfo.contractDefId = param.defId;
                }
                if (this.mainInfo.contractDefId) {
                    this.loadCompanyList();
                }
                if (param.isContractPerfect) {
                    this.isContractPerfect = param.isContractPerfect;
                }
            },
            changeCsType: function (value) {
                this.mainInfo.cSList[0].name = '';
                this.mainInfo.cSList[0].idno = '';
                this.mainInfo.cSList[0].email = '';
                this.mainInfo.cSList[0].contactName = '';
                this.mainInfo.cSList[0].contactPhone = '';
                this.mainInfo.cSList[0].address = '';
            },
            searchCustomerByNo: function (value) {
                var vm = this;
                if (value.indexOf(' ') == -1) {
                    this.request({
                        url: "/signCloud/contractBuilder/getCustomerList.do",
                        loading: false,
                        data: {
                            type: this.mainInfo.cSList[0].type,
                            name: '',
                            idno: value
                        }
                    }).then(function (data) {
                        vm.customerListNo = data;
                        vm.$refs.autoNO.toggleMenu(data && data.length > 0);
                    });
                }
            },
            selectCustomer: function (value) {
                var vm = this;
                this.customerList.map(function (item) {
                    if (item.name == value) {
                        vm.mainInfo.cSList[0].idno = item.IDNumber;
                        vm.mainInfo.cSList[0].email = item.email;
                        vm.mainInfo.cSList[0].address = item.address;
                        vm.mainInfo.cSList[0].contactName = item.linkmanName;
                        vm.mainInfo.cSList[0].contactPhone = item.linkmanPhone;
                        vm.$set(vm.mainInfo.cSList, 0, vm.mainInfo.cSList[0]);
                    }
                });
            },
            selectCustomerNo: function (value) {
                var vm = this;
                this.customerListNo.map(function (item) {
                    if (item.IDNumber == value) {
                        vm.mainInfo.cSList[0].name = item.name;
                        vm.mainInfo.cSList[0].email = item.email;
                        vm.mainInfo.cSList[0].address = item.address;
                        vm.mainInfo.cSList[0].contactName = item.linkmanName;
                        vm.mainInfo.cSList[0].contactPhone = item.linkmanPhone;
                        vm.$set(vm.mainInfo.cSList, 0, vm.mainInfo.cSList[0]);
                    }
                });
            },
            searchCustomerByName: function (value) {
                var vm = this;
                if (value.indexOf(' ') == -1) {
                    this.request({
                        url: "/signCloud/contractBuilder/getCustomerList.do",
                        loading: false,
                        data: {
                            type: this.mainInfo.cSList[0].type,
                            name: value,
                            idno: ''
                        }
                    }).then(function (data) {
                        vm.customerList = data;
                        vm.$refs.autoName.toggleMenu(data && data.length > 0);
                    });
                }
            },
            selectArea: function (value) {
                this.selectedArea = value;
            },
            selectInfo: function (name) {
                var selectRow = {};
                var vm = this;
                this.companyList.map(function (item) {
                    if (item.name == name) {
                        vm.$set(vm.mainInfo.cSList[1], 'bankName', item.bankName);
                        vm.$set(vm.mainInfo.cSList[1], 'bankAccount', item.bankAccount);
                        vm.$set(vm.mainInfo.cSList[1], 'orgId', item.orgId);
                        vm.$set(vm.mainInfo.cSList[1], 'idno', item.idno);
                        vm.$set(vm.mainInfo.cSList[1], 'email', item.email);
                        vm.$set(vm.mainInfo.cSList[1], 'address', item.address);
                        if (vm.op != 'edit') {
                            vm.$set(vm.mainInfo.cSList[1], 'contactName', item.contactName);
                            vm.$set(vm.mainInfo.cSList[1], 'contactPhone', item.contactPhone);
                        }
                    }
                });
            },
            loadCompanyList: function () {
                var vm = this;
                this.request({
                    url: "/signCloud/contractBuilder/loadCompanyList.do?defId=" + this.mainInfo.contractDefId
                }).then(function (data) {
                    vm.companyList = data;
                });
            },
            changePayment: function (paymentArray) {
                this.mainInfo.payment = "";
                if (paymentArray && paymentArray.length > 0) {
                    for (var i = 0; i < paymentArray.length; i++) {
                        this.mainInfo.payment = this.mainInfo.payment + paymentArray[i] + ",";
                    }
                    if (this.mainInfo.payment != "") {
                        this.mainInfo.payment = this.mainInfo.payment.substring(0, this.mainInfo.payment.length - 1);
                    }
                }
            },
            loadData: function (contractId) {
                var vm = this;
                this.$set(this.mainInfo.cSList[0], "type", null);
                this.request({
                    url: "/signCloud/contractBuilder/view.do?id=" + contractId
                }).then(function (data) {
                    vm.mainInfo = Object.assign(vm.mainInfo, data);
                    var content = vm.mainInfo.content;
                    vm.mainInfo.content = JSON.parse(content);
                    if (vm.mainInfo.periodEnd) {
                        vm.mainInfo.periodEnd = new Date(vm.mainInfo.periodEnd);
                    }
                    if (vm.mainInfo.periodStart) {
                        vm.mainInfo.periodStart = new Date(vm.mainInfo.periodStart);
                    }
                    if (vm.mainInfo.payment && vm.mainInfo.payment != "") {
                        vm.tempPayment = vm.mainInfo.payment.split(",");
                    }
                    if (!vm.mainInfo.content.otherItem || vm.mainInfo.content.otherItem.length == 0) {
                        vm.addFileRow();
                    }
                    if (!vm.mainInfo.contentAttList) {
                        vm.mainInfo.contentAttList = [];
                    }
                    vm.$api.renderInsteadFromTemplate(data);
                });
            },
            getPayMonths: function () {
                var months = 0;
                if (this.mainInfo.content.serviceFrequency == 'PERIODIC') {
                    if (this.mainInfo.periodType == 'START_END') {
                        months = Number(this.mainInfo.content.totalMonth) - Number(this.mainInfo.content.freeMonth ? this.mainInfo.content.freeMonth : 0);
                    } else {
                        months = Number(this.mainInfo.content.noneTypeMonth) - Number(this.mainInfo.content.noneTypeFreeMonth ? this.mainInfo.content.noneTypeFreeMonth : 0);
                    }
                }
                if (isNaN(months))
                    months = 0;
                return months;
            },
            changePayPrice: function (event) {
                var ref = {
                    MONTHLY: 1,
                    QUARTERLY: 3,
                    HALF_YEAR: 6,
                    PER_YEAR: 12
                };
                this.singlePrice = ((isNaN(this.mainInfo.content.payWayRoundDaysItem) ? 0 : this.mainInfo.content.payWayRoundDaysItem)/ref[this.mainInfo.content.payType]);
                if (this.singlePrice) {
                    this.singlePrice = this.singlePrice.toFixed(2);
                }else {
                    this.singlePrice = 0;
                }
            },
            changeStartDate: function (start) {
                if (start != '') {
                    var startDate = new Date(start);
                    var endDate = this.mainInfo.periodEnd;
                    if (endDate != "") {
                        var months = Math.round((endDate - startDate) / (1000 * 3600 * 24 * 30)) + 1;
                        this.mainInfo.periodStart = startDate;
                        this.$set(this.mainInfo.content, "totalMonth", months + "");
                    }
                } else {
                    this.$set(this.mainInfo.content, "totalMonth", "");
                }
            },
            changeEndDate: function (end) {
                if (end != '') {
                    var startDate = this.mainInfo.periodStart;
                    var endDate = new Date(end);
                    if (startDate != "") {
                        var months = Math.round((endDate - startDate) / (1000 * 3600 * 24 * 30)) + 1;
                        this.mainInfo.periodEnd = endDate;
                        this.$set(this.mainInfo.content, "totalMonth", months + "");
                    }
                } else {
                    this.$set(this.mainInfo.content, "totalMonth", "");
                }
            },
            changePaymentType: function (data) {
                if (data != '') {
                    var ref = {
                        MONTHLY: 1,
                        QUARTERLY: 3,
                        HALF_YEAR: 6,
                        PER_YEAR: 12
                    };
                    var perPrice = this.singlePrice * ref[data];
                    if (perPrice) {
                        perPrice = Math.floor(perPrice);
                    }else {
                        perPrice = 0;
                    }
                    this.mainInfo.content.payWayRoundDaysItem = perPrice;
                }
            },
            save: function (callBack) {
                var vm = this;
                vm.$refs['mainInfo'].validate(function (valid) {
                    if (valid) {
                        if (vm.mainInfo.periodType == 'START_END' && vm.mainInfo.periodStart > vm.mainInfo.periodEnd) {
                            vm.$Message.error({content: "开始时间不能大于结束时间!", duration: 3});
                            return;
                        }
                        var cRList = [];
                        if (vm.mainInfo.cSList[0].type == "COMPANY") {
                            vm.mainInfo.cSList[0].signedType = "SEAL";
                        } else {
                            vm.mainInfo.cSList[0].signedType = "SIGNATURE";
                        }
                        var cSList = [vm.mainInfo.cSList[0], vm.mainInfo.cSList[1],vm.mainInfo.cSList[2]];
                        if (vm.mainInfo.paymentType == 'ONCE') {
                            cRList.push({
                                price: vm.mainInfo.price,
                                title: '一次性支付',
                                idx: 1
                            });
                        } else if (vm.mainInfo.paymentType == 'BATCH') {
                            cRList.push({
                                price: vm.mainInfo.content.payWayMonthlyFirstPay,
                                title: '第1笔支付',
                                idx: 1
                            });
                            cRList.push({
                                price: vm.mainInfo.content.payWayMonthlyOtherPay,
                                title: '第2笔支付',
                                idx: 2
                            });
                        } else {
                            var payType = vm.mainInfo.content.payType;
                            var ref = {
                                MONTHLY: 1,
                                QUARTERLY: 3,
                                HALF_YEAR: 6,
                                PER_YEAR: 12
                            };
                            var payMonths = vm.getPayMonths();
                            var total = vm.mainInfo.price;
                            for (var i = 0; i < Math.ceil(payMonths / ref[payType]); i++) {
                                if (total > 0) {
                                    if ((i + 1) == Math.ceil(payMonths / ref[payType])) {
                                        cRList.push({
                                            price: total,
                                            title: '第' + (i + 1) + "笔支付",
                                            idx: (i + 1)
                                        });
                                    } else {
                                        cRList.push({
                                            price: vm.mainInfo.content.payWayRoundDaysItem,
                                            title: '第' + (i + 1) + "笔支付",
                                            idx: (i + 1)
                                        });
                                        total -= vm.mainInfo.content.payWayRoundDaysItem;
                                    }
                                }
                            }
                        }

                        if (vm.mainInfo.content.otherItem) {
                            var newOtherItem = [];
                            vm.mainInfo.content.otherItem.forEach(function(item, index) {
                                console.info(item.content);
                                if (!String.isNullOrBlank(item.content)) {
                                    newOtherItem.push(item);
                                }
                            });
                            vm.mainInfo.content.otherItem = newOtherItem;
                        }
                        var sendData = Object.assign({}, vm.mainInfo);
                        sendData.cRList = cRList;
                        sendData.cSList = cSList;
                        sendData.payment = vm.mainInfo.payment;
                        sendData.content = JSON.stringify(vm.mainInfo.content);
                        if (vm.mainInfo.periodType == 'START_END') {
                            sendData.periodStart = sendData.periodStart.getTime();
                            sendData.periodEnd = sendData.periodEnd.getTime();
                        }
                        callBack(sendData);
                    } else {
                        callBack(false);
                    }
                });
            },
            addFileRow: function () {
                var fileObj = {content: ''};
                this.mainInfo.content.otherItem.push(fileObj);
            },
            removeFileRow: function (index) {
                this.mainInfo.content.otherItem.splice(index, 1);
            },
            beforeFileUpload: function () {
            },
            onFileSuccess: function (id,file) {
                let name = file.name;
                let type = name.substring(name.lastIndexOf('.') + 1, name.length);
                this.mainInfo.contentAttList.push({
                    contentAttachmentId: id,
                    fileName: name,
                    type: type
                });
            },
            showFile: function (contentAttachmentId) {
                window.open('/ossController/oss/file.do?id=' + contentAttachmentId);
            },
            removeFile: function (index) {
                debugger;
                this.mainInfo.contentAttList.splice(index,1);
            },
        }
    })
</script>